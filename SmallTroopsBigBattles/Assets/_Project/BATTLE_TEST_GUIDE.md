# 戰鬥系統測試指南

## 快速開始

### 方法一：使用測試按鈕（推薦）

1. 運行遊戲
2. 在 HUD 底部找到 **「測試戰鬥」** 按鈕
3. 點擊按鈕即可自動創建測試戰場並開始戰鬥

### 方法二：使用測試面板

1. 運行遊戲
2. 打開戰鬥測試面板（如果已設置）
3. 點擊 **「創建測試戰場」** 按鈕
4. 戰鬥會自動開始

### 方法三：使用編輯器菜單

1. 在 Unity 編輯器中
2. 選擇 `Tools > SLG Game > Setup Battle Test UI`
3. 這會自動設置測試 UI 和按鈕

## 測試功能說明

### BattleTester 組件功能

- **創建測試戰場**：自動創建一個攻守雙方對戰的戰場
- **添加士兵**：向戰場添加更多測試士兵
- **加速/正常速度**：切換戰鬥速度（1x / 3x）
- **暫停/繼續**：暫停或繼續戰鬥

### 測試戰場設定

- **攻方**：蜀國（nation_shu）
- **守方**：魏國（nation_wei）
- **城牆血量**：5000
- **初始士兵數**：每方約 50 名（可調整）

### 測試士兵配置

默認每方包含：
- 槍兵：50 名
- 盾兵：25 名
- 騎兵：17 名
- 弓兵：25 名

## 觀察戰鬥

### 戰鬥面板顯示

- **頂部**：雙方兵力統計和存活率
- **中央**：戰場視圖（可拖動、縮放）
- **底部**：我的部隊狀態、增援/撤退按鈕

### 戰鬥資訊

- 戰場士兵數量
- 各陣營存活數
- 城牆血量百分比
- 戰鬥持續時間

## 測試場景

### 場景位置
- `Assets/_Project/Scenes/MainGame.unity`

### 必要組件

確保場景中有：
- `[GameManager]` - 遊戲管理器
- `[UIManager]` - UI 管理器
- `MainCanvas` - 主畫布
- `BattleTester` - 戰鬥測試器（可選，會自動創建）

## 常見問題

### Q: 戰鬥沒有開始？
A: 檢查 BattleManager 是否已初始化，確保 GameManager 已啟動

### Q: 看不到士兵？
A: 檢查 BattlefieldView 是否正確初始化，確保士兵 UI 預製體已設置

### Q: 戰鬥結束太快？
A: 可以通過 BattleTester 的 `testSoldierCount` 參數增加初始士兵數量

### Q: 如何測試大量士兵？
A: 在 BattleTester 組件中設置 `testSoldierCount` 為更大的值（如 200）

## 調試技巧

### 查看日誌

戰鬥系統會輸出詳細的日誌：
- `[BattleManager]` - 戰鬥管理日誌
- `[BattleTester]` - 測試器日誌
- `[SoldierAI]` - 士兵 AI 日誌（如果啟用）

### 性能監控

- 觀察戰場士兵數量（應控制在 1000 以內）
- 監控 FPS（大量士兵時可能下降）
- 檢查對象池使用情況

### 測試不同場景

1. **小規模戰鬥**：testSoldierCount = 20
2. **中等規模**：testSoldierCount = 50（默認）
3. **大規模戰鬥**：testSoldierCount = 200
4. **極限測試**：testSoldierCount = 500

## 下一步開發

測試完成後，可以繼續開發：
- 戰鬥 UI 優化
- 士兵動畫和特效
- 音效系統
- 戰報詳細顯示
- 回放功能

